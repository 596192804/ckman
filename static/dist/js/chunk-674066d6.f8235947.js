(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-674066d6"],{"670c":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",{staticClass:"home-setting"},[n("breadcrumb",{attrs:{data:["setting"]}}),n("el-form",{ref:"Form",attrs:{model:e.formModel,"label-width":"280px","label-position":"left"}},[n("el-form-item",{attrs:{label:"Ckman HA Pair Addresses:",prop:"peers"}},[n("el-input",{staticClass:"width-350",attrs:{placeholder:"多个ip逗号分隔"},model:{value:e.formModel.peers,callback:function(t){e.$set(e.formModel,"peers",t)},expression:"formModel.peers"}})],1),n("el-form-item",{attrs:{label:"Prometheus Addresses:",prop:"prometheus"}},[n("el-input",{staticClass:"width-350",attrs:{placeholder:"多个ip逗号分隔"},model:{value:e.formModel.prometheus,callback:function(t){e.$set(e.formModel,"prometheus",t)},expression:"formModel.prometheus"}})],1),n("el-form-item",{attrs:{label:"Alert Manager Addresses:",prop:"alertManagers"}},[n("el-input",{staticClass:"width-350",attrs:{placeholder:"多个ip逗号分隔"},model:{value:e.formModel.alertManagers,callback:function(t){e.$set(e.formModel,"alertManagers",t)},expression:"formModel.alertManagers"}})],1)],1),n("el-button",{staticClass:"ml-360",attrs:{type:"primary"},on:{click:e.saveConfig}},[e._v("Save & Reboot")]),n("section",{staticClass:"rpms"},[n("el-divider",{attrs:{"content-position":"left"}},[e._v("ClickHouse RPMs")]),n("rpm-list")],1)],1)},a=[],o=n("a34a"),s=n.n(o),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"rpms text-right"},[n("el-button",{staticClass:"mb-15",attrs:{type:"primary"},on:{click:e.chooseFile}},[e._v("Upload RPMs")]),n("el-table",{attrs:{data:e.list,border:""}},[n("el-table-column",{attrs:{prop:"version","show-overflow-tooltip":"",label:"Version",align:"center"}}),n("el-table-column",{attrs:{prop:"files","show-overflow-tooltip":"",label:"Files",align:"center","min-width":"500"}}),n("el-table-column",{attrs:{label:"Action",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[[n("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Delete",expression:"'Delete'"}],staticClass:"fa fa-trash pointer fs-18",on:{click:function(t){return e.remove(r)}}})]]}}])})],1)],1)},c=[],l=n("c949"),u=n("08ba"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("el-upload",{staticClass:"width-full",attrs:{action:"void",multiple:"","auto-upload":!1,"file-list":e.fileList,"on-change":e.changeFile,"on-remove":e.removeFile,accept:".rpm"}},[n("el-button",{staticClass:"mb-15",attrs:{type:"primary"}},[e._v("Upload RPMs")])],1),e.uploadPercent>0?n("el-progress",{attrs:{"text-inside":!0,"stroke-width":15,percentage:e.uploadPercent}}):e._e()],1)},p=[];function d(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,a)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){d(o,r,a,s,i,"next",e)}function i(e){d(o,r,a,s,i,"throw",e)}s(void 0)}))}}var h={data:function(){return{fileList:[],uploadPercent:0}},mounted:function(){},methods:{changeFile:function(){this.fileList=arguments.length<=1?void 0:arguments[1]},removeFile:function(){this.fileList=arguments.length<=1?void 0:arguments[1]},onOk:function(){var e=this;return m(s.a.mark((function t(){var n;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.fileList.length){t.next=7;break}return n=e.fileList.map((function(t){var n=new FormData;return n.append("package",t.raw),l["d"].upload(n,{onUploadProgress:function(t){var n=0|Math.floor(t.loaded/t.total*100);e.uploadPercent=n}})})),t.next=4,Promise.all(n);case 4:e.$message.success("rpm包上传成功"),t.next=9;break;case 7:return e.$message.warning("请选取文件"),t.abrupt("return",Promise.reject());case 9:case"end":return t.stop()}}),t)})))()}}},v=h,w=n("2877"),b=Object(w["a"])(v,f,p,!1,null,null,null),g=b.exports;function x(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,a)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){x(o,r,a,s,i,"next",e)}function i(e){x(o,r,a,s,i,"throw",e)}s(void 0)}))}}var M={data:function(){return{list:[]}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;return k(s.a.mark((function t(){var n,r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.list=[],t.next=3,l["d"].getList();case 3:n=t.sent,r=n.data.entity,r.forEach((function(t){e.list.push({version:t,files:"clickhouse-client-".concat(t,"-2.noarch.rpm,clickhouse-common-static-").concat(t,"-2.x86_64.rpm,clickhouse-server-").concat(t,"-2.noarch.rpm")})}));case 6:case"end":return t.stop()}}),t)})))()},chooseFile:function(){var e=this;return k(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["b"])({props:{title:"Upload File",width:"650px",cancelText:"Cancel",okText:"Upload"},component:g});case 2:e.fetchData();case 3:case"end":return t.stop()}}),t)})))()},remove:function(e){var t=this;return k(s.a.mark((function n(){return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$confirm("Confirm whether to delete ?","Tip",{confirmButtonText:"Delete",cancelButtonText:"Cancel",text:"warning"});case 2:return n.next=4,l["d"].deletePackage({packageVersion:e.version});case 4:t.$message.success("".concat(e.version,"版本已删除成功")),t.fetchData();case 6:case"end":return n.stop()}}),n)})))()}}},C=M,P=Object(w["a"])(C,i,c,!1,null,null,null),y=P.exports,_=n("c281");function $(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,a)}function D(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){$(o,r,a,s,i,"next",e)}function i(e){$(o,r,a,s,i,"throw",e)}s(void 0)}))}}var F={name:"HomeSetting",data:function(){return{formModel:{peers:"",prometheus:"",alertManagers:""}}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;return D(s.a.mark((function t(){var n,r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["d"].getConfig();case 2:n=t.sent,r=n.data.entity,Object.keys(r).forEach((function(t){e.formModel[t]=r[t]?r[t].join(","):""}));case 5:case"end":return t.stop()}}),t)})))()},saveConfig:function(){var e=this;return D(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return Object.keys(e.formModel).forEach((function(t){e.formModel[t]=e.formModel[t]?Object(_["b"])(e.formModel[t]):null})),t.next=3,l["d"].updateConfig(e.formModel);case 3:e.$message.success("配置已更新");case 4:case"end":return t.stop()}}),t)})))()}},components:{RpmList:y}},j=F,L=(n("c9b9"),Object(w["a"])(j,r,a,!1,null,"5e747804",null));t["default"]=L.exports},"894a":function(e,t,n){},c9b9:function(e,t,n){"use strict";var r=n("894a"),a=n.n(r);a.a}}]);