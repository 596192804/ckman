(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01ab8d14"],{"77b8":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"home"},[r("section",{staticClass:"flex flex-wrap"},[r("div",{staticClass:"flex-1"},[e._m(0),r("div",{staticClass:"btns flex flex-column width-6"},[r("el-button",{staticClass:"mb-20 fs-18",attrs:{type:"primary",size:"large"},on:{click:function(t){return e.importCk(1)}}},[e._v("Create a ClickHouse Cluster")]),r("el-button",{staticClass:"fs-18",attrs:{type:"primary",size:"large"},on:{click:function(t){return e.importCk(0)}}},[e._v("Import a ClickHouse Cluster")])],1)]),r("div",{staticClass:"flex-1"},[e._m(1),r("div",{staticClass:"btns flex flex-column width-6"},[r("router-link",{staticClass:"el-button mb-20 fs-18 el-button--primary el-button--large",attrs:{to:"/loader"}},[e._v("Data Loader Management")])],1)])]),r("div",{staticClass:"list mt-50"},[r("p",{staticClass:"font-bold mb-10 fs-18"},[e._v("All ClickHouse Clusters")]),r("el-table",{attrs:{data:e.list,border:"","header-cell-class-name":"header-cell-class-name"}},[r("el-table-column",{attrs:{prop:"cluster","show-overflow-tooltip":"",label:"Cluster Name"}}),r("el-table-column",{attrs:{prop:"mode","show-overflow-tooltip":"",label:"Mode"}}),r("el-table-column",{attrs:{prop:"isReplica","show-overflow-tooltip":"",label:"Replica"}}),r("el-table-column",{attrs:{prop:"hosts","show-overflow-tooltip":"",label:"ClickHouse Node IP"}}),r("el-table-column",{attrs:{prop:"count","show-overflow-tooltip":"",label:"ClickHouse Node Count"}}),r("el-table-column",{attrs:{prop:"zkNodes","show-overflow-tooltip":"",label:"Zookeeper Node List"}}),r("el-table-column",{attrs:{label:"Actions"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[[r("el-link",{attrs:{type:"primary",underline:""},on:{click:function(t){return t.preventDefault(),e.toCluster(o)}}},[r("router-link",{attrs:{to:"/clusters/"+o.cluster}},[e._v("Go to cluster")])],1),r("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Delete",expression:"'Delete'"}],staticClass:"fa fa-trash pointer fs-18 ml-15",on:{click:function(t){return e.remove(o)}}})]]}}])})],1)],1)])},s=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"title flex flex-column mb-30"},[r("p",{staticClass:"mb-5",staticStyle:{"font-size":"40px"}},[r("i",{staticClass:"fa fa-database"}),r("span",{staticClass:"inline-block ml-10 font-bold"},[e._v("Provision")])]),r("p",{staticClass:"fs-14 font-bold"},[e._v("Create or import a ClickHouse Cluster")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"title flex flex-column mb-30"},[r("p",{staticClass:"mb-5",staticStyle:{"font-size":"40px"}},[r("i",{staticClass:"fa fa-database"}),r("span",{staticClass:"inline-block ml-10 font-bold"},[e._v("Loader")])]),r("p",{staticClass:"fs-14 font-bold"},[e._v("Data loader management")])])}],a=r("a34a"),n=r.n(a),l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"createCk"},[r("el-form",{ref:"Form",attrs:{model:e.formModel,"label-width":"150px"}},[e.type?r("el-form-item",{attrs:{label:"ClickHouse Version:",prop:"packageVersion",required:""}},[r("el-select",{staticClass:"width-350",attrs:{size:"small",clearable:"",filterable:""},model:{value:e.formModel.packageVersion,callback:function(t){e.$set(e.formModel,"packageVersion",t)},expression:"formModel.packageVersion"}},e._l(e.versionOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),r("el-form-item",{attrs:{label:"Cluster Name:",prop:"cluster",required:""}},[r("el-input",{staticClass:"width-350",model:{value:e.formModel.cluster,callback:function(t){e.$set(e.formModel,"cluster",t)},expression:"formModel.cluster"}})],1),e.type?e._e():r("el-form-item",{attrs:{label:"ClickHouse Node IP:",prop:"hosts",required:""}},[r("el-input",{staticClass:"width-350",attrs:{type:"textarea",autosize:{minRows:2},placeholder:"多个ip,请以逗号,分隔填写"},model:{value:e.formModel.hosts,callback:function(t){e.$set(e.formModel,"hosts",t)},expression:"formModel.hosts"}})],1),r("el-form-item",{attrs:{label:"ClickHouse TCP Port:",prop:"port",required:""}},[r("el-input",{staticClass:"width-350",model:{value:e.formModel.port,callback:function(t){e.$set(e.formModel,"port",t)},expression:"formModel.port"}})],1),e.type?r("el-form-item",{attrs:{label:"ClickHouse Node List:",prop:"hosts",required:""}},[r("el-input",{staticClass:"width-350",attrs:{type:"textarea",autosize:{minRows:2},placeholder:"多个ip,请以逗号,分隔填写"},model:{value:e.formModel.hosts,callback:function(t){e.$set(e.formModel,"hosts",t)},expression:"formModel.hosts"}})],1):e._e(),e.type?r("el-form-item",{attrs:{label:"Replica",prop:"isReplica"}},[r("el-switch",{model:{value:e.formModel.isReplica,callback:function(t){e.$set(e.formModel,"isReplica",t)},expression:"formModel.isReplica"}})],1):e._e(),r("el-form-item",{attrs:{label:"Zookeeper Node List:",prop:"zkNodes",required:""}},[r("el-input",{staticClass:"width-350",attrs:{type:"textarea",autosize:{minRows:2},placeholder:"多个ip,请以逗号,分隔填写"},model:{value:e.formModel.zkNodes,callback:function(t){e.$set(e.formModel,"zkNodes",t)},expression:"formModel.zkNodes"}})],1),r("el-form-item",{attrs:{label:"ZooKeeper Port:",prop:"zkPort",required:""}},[r("el-input",{staticClass:"width-350",model:{value:e.formModel.zkPort,callback:function(t){e.$set(e.formModel,"zkPort",t)},expression:"formModel.zkPort"}})],1),r("el-form-item",{attrs:{label:"ZK Status Port:",prop:"zkStatusPort",required:""}},[r("el-input",{staticClass:"width-350",model:{value:e.formModel.zkStatusPort,callback:function(t){e.$set(e.formModel,"zkStatusPort",t)},expression:"formModel.zkStatusPort"}})],1),e.type?r("el-form-item",{attrs:{label:"Data path:",prop:"path",required:""}},[r("el-input",{staticClass:"width-350",model:{value:e.formModel.path,callback:function(t){e.$set(e.formModel,"path",t)},expression:"formModel.path"}})],1):e._e(),r("el-form-item",{attrs:{label:"Cluster Username:",prop:"user",required:""}},[r("el-input",{staticClass:"width-350",model:{value:e.formModel.user,callback:function(t){e.$set(e.formModel,"user",t)},expression:"formModel.user"}})],1),r("el-form-item",{attrs:{label:"Cluster Password:",prop:"password",required:""}},[r("el-input",{staticClass:"width-350",attrs:{type:"password","show-password":"",autocomplete:"new-password"},model:{value:e.formModel.password,callback:function(t){e.$set(e.formModel,"password",t)},expression:"formModel.password"}})],1),e.type?r("el-form-item",{attrs:{label:"SSH Username:",prop:"sshUser",required:""}},[r("el-input",{staticClass:"width-350",model:{value:e.formModel.sshUser,callback:function(t){e.$set(e.formModel,"sshUser",t)},expression:"formModel.sshUser"}})],1):e._e(),e.type?r("el-form-item",{attrs:{label:"SSH Password:",prop:"sshPassword",required:""}},[r("el-input",{staticClass:"width-350",attrs:{type:"password","show-password":"",autocomplete:"new-password"},model:{value:e.formModel.sshPassword,callback:function(t){e.$set(e.formModel,"sshPassword",t)},expression:"formModel.sshPassword"}})],1):e._e()],1)],1)},i=[],c=r("e621"),u=r("6071"),p=r("e56b"),f=r("7129"),d=r("2332");function m(e){return m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function h(e,t,r){if(!Object(d["a"])(r))return!1;var o=m(t);return!!("number"==o?Object(p["a"])(r)&&Object(f["a"])(t,r.length):"string"==o&&t in r)&&Object(u["a"])(r[t],e)}var b=h,v=/\s/;function w(e){var t=e.length;while(t--&&v.test(e.charAt(t)));return t}var k=w,C=/^\s+/;function y(e){return e?e.slice(0,k(e)+1).replace(C,""):e}var x=y,M=r("1bc6"),P=NaN,z=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,O=/^0o[0-7]+$/i,$=parseInt;function S(e){if("number"==typeof e)return e;if(Object(M["a"])(e))return P;if(Object(d["a"])(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(d["a"])(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=x(e);var r=g.test(e);return r||O.test(e)?$(e.slice(2),r?2:8):z.test(e)?P:+e}var _=S,j=1/0,N=17976931348623157e292;function H(e){if(!e)return 0===e?e:0;if(e=_(e),e===j||e===-j){var t=e<0?-1:1;return t*N}return e===e?e:0}var q=H;function D(e){var t=q(e),r=t%1;return t===t?r?t-r:t:0}var R=D,A=Math.ceil,V=Math.max;function I(e,t,r){t=(r?b(e,t,r):void 0===t)?1:V(R(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];var s=0,a=0,n=Array(A(o/t));while(s<o)n[a++]=Object(c["a"])(e,s,s+=t);return n}var U=I,T=r("c949"),E=r("c281");function L(e,t,r,o,s,a,n){try{var l=e[a](n),i=l.value}catch(c){return void r(c)}l.done?t(i):Promise.resolve(i).then(o,s)}function B(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){L(a,o,s,n,l,"next",e)}function l(e){L(a,o,s,n,l,"throw",e)}n(void 0)}))}}var Z={props:["type","versionOptions"],data:function(){return{formModel:{packageVersion:"",cluster:"",hosts:"",zkNodes:"",user:"",password:"",sshUser:"",sshPassword:"",isReplica:!1,port:9e3,zkPort:2181,zkStatusPort:8080,path:""}}},methods:{dealShards:function(e,t){var r=this;return B(n.a.mark((function o(){var s;return n.a.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e){o.next=4;break}return o.abrupt("return",t.map((function(e){return{replicas:[{ip:e}]}})));case 4:if(s=t.length%2,!s){o.next=10;break}return r.$message.warning("hosts字段ip数量有误"),o.abrupt("return",Promise.reject());case 10:return o.abrupt("return",U(t,2).map((function(e){return{replicas:e.map((function(e){return{ip:e}}))}})));case 11:case"end":return o.stop()}}),o)})))()},onOk:function(){var e=this;return B(n.a.mark((function t(){var r,o,s,a,l,i,c,u,p,f,d,m,h,b,v;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.Form.validate();case 2:if(r=e.formModel,o=r.packageVersion,s=r.cluster,a=r.hosts,l=r.zkNodes,i=r.user,c=r.password,u=r.sshUser,p=r.sshPassword,f=r.isReplica,d=r.port,m=r.zkPort,h=r.zkStatusPort,b=r.path,e.type){t.next=8;break}return t.next=6,T["a"].importCluster({cluster:s,hosts:Object(E["b"])(a),port:+d,user:i,password:c,zkNodes:Object(E["b"])(l),zkPort:+m,zkStatusPort:+h});case 6:t.next=14;break;case 8:return console.log(Object(E["b"])(a)),t.next=11,e.dealShards(f,Object(E["b"])(a));case 11:return v=t.sent,t.next=14,T["a"].createCluster({clickhouse:{ckTcpPort:+d,clusterName:s,shards:v,packageVersion:o,password:c,path:b,user:i,zkNodes:Object(E["b"])(l),zkPort:+m,zkStatusPort:+h},hosts:Object(E["b"])(a),password:p,user:u});case 14:case"end":return t.stop()}}),t)})))()}},components:{}},F=Z,J=r("2877"),K=Object(J["a"])(F,l,i,!1,null,"65a375dd",null),G=K.exports,Q=r("08ba");function W(e,t){return re(e)||te(e,t)||Y(e,t)||X()}function X(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Y(e,t){if(e){if("string"===typeof e)return ee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function te(e,t){var r=e&&("undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var o,s,a=[],n=!0,l=!1;try{for(r=r.call(e);!(n=(o=r.next()).done);n=!0)if(a.push(o.value),t&&a.length===t)break}catch(i){l=!0,s=i}finally{try{n||null==r["return"]||r["return"]()}finally{if(l)throw s}}return a}}function re(e){if(Array.isArray(e))return e}function oe(e,t,r,o,s,a,n){try{var l=e[a](n),i=l.value}catch(c){return void r(c)}l.done?t(i):Promise.resolve(i).then(o,s)}function se(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){oe(a,o,s,n,l,"next",e)}function l(e){oe(a,o,s,n,l,"throw",e)}n(void 0)}))}}var ae={name:"Home",data:function(){return{list:[],versionOptions:[]}},mounted:function(){this.fetchVersionData(),this.fetchData()},methods:{fetchData:function(){var e=this;return se(n.a.mark((function t(){var r,o;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.list=[],t.next=3,T["a"].getCluster();case 3:r=t.sent,o=r.data.entity,Object.entries(o).forEach((function(t){var r=W(t,2),o=(r[0],r[1]);o.count=o.hosts.length,o.hosts=o.hosts.join(","),o.zkNodes=o.zkNodes.join(","),e.list.unshift(o)}));case 6:case"end":return t.stop()}}),t)})))()},fetchVersionData:function(){var e=this;return se(n.a.mark((function t(){var r,o;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,T["d"].getList();case 2:r=t.sent,o=r.data.entity,e.versionOptions=o.map((function(e){return{value:e,label:e}}));case 5:case"end":return t.stop()}}),t)})))()},importCk:function(e){var t=this;return se(n.a.mark((function r(){var o;return n.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(Q["b"])({component:G,props:{title:e?"Create a new ClickHouse Cluster":"Import a ClickHouse Cluster",width:600,cancelText:"Cancel",okText:e?"Create":"Import"},data:{type:e,versionOptions:t.versionOptions}});case 2:o=t.type?"创建成功":"导入成功",t.$message.success("".concat(o)),t.fetchData();case 5:case"end":return r.stop()}}),r)})))()},toCluster:function(e){this.$root.clusterBench=e,delete this.$root.clusterBench.count},remove:function(e){var t=this;return se(n.a.mark((function r(){return n.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("Confirm whether to delete ?","Tip",{confirmButtonText:"Delete",cancelButtonText:"Cancel",text:"warning"});case 2:return r.next=4,T["a"].deleteCluster("".concat(e.cluster));case 4:t.$message.success("".concat(e.cluster," Cluster 已删除")),t.fetchData();case 6:case"end":return r.stop()}}),r)})))()}}},ne=ae,le=(r("bba5"),Object(J["a"])(ne,o,s,!1,null,"6078a0e0",null));t["default"]=le.exports},bba5:function(e,t,r){"use strict";var o=r("ca3c"),s=r.n(o);s.a},ca3c:function(e,t,r){},e621:function(e,t,r){"use strict";function o(e,t,r){var o=-1,s=e.length;t<0&&(t=-t>s?0:s+t),r=r>s?s:r,r<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;var a=Array(s);while(++o<s)a[o]=e[o+t];return a}t["a"]=o}}]);