(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-92e732bc"],{"0148":function(t,e,n){"use strict";function s(t,e,n,s){var a=t.length,i=n+(s?1:-1);while(s?i--:++i<a)if(e(t[i],i,t))return i;return-1}var a=s;function i(t){return t!==t}var l=i;function c(t,e,n){var s=n-1,a=t.length;while(++s<a)if(t[s]===e)return s;return-1}var r=c;function u(t,e,n){return e===e?r(t,e,n):a(t,l,n)}e["a"]=u},1607:function(t,e,n){"use strict";var s=n("70de"),a=n.n(s);a.a},3355:function(t,e,n){"use strict";function s(t){return null===t}e["a"]=s},"6e7d":function(t,e,n){"use strict";var s=n("814e"),a=n.n(s);a.a},"70de":function(t,e,n){},"814e":function(t,e,n){},8591:function(t,e,n){"use strict";var s=n("d045"),a=n.n(s);a.a},"8cbb":function(t,e,n){"use strict";var s=n("9ac7"),a=n("0148");function i(t,e){var n=null==t?0:t.length;return!!n&&Object(a["a"])(t,e,0)>-1}var l=i;function c(t,e,n){var s=-1,a=null==t?0:t.length;while(++s<a)if(n(e,t[s]))return!0;return!1}var r=c,u=n("6568"),o=n("a55c");function f(){}var h=f,p=n("1989"),d=1/0,v=o["a"]&&1/Object(p["a"])(new o["a"]([,-0]))[1]==d?function(t){return new o["a"](t)}:h,m=v,b=200;function g(t,e,n){var a=-1,i=l,c=t.length,o=!0,f=[],h=f;if(n)o=!1,i=r;else if(c>=b){var d=e?null:m(t);if(d)return Object(p["a"])(d);o=!1,i=u["a"],h=new s["a"]}else h=e?[]:f;t:while(++a<c){var v=t[a],g=e?e(v):v;if(v=n||0!==v?v:0,o&&g===g){var q=h.length;while(q--)if(h[q]===g)continue t;e&&h.push(g),f.push(v)}else i(h,g,n)||(h!==f&&h.push(g),f.push(v))}return f}e["a"]=g},d045:function(t,e,n){},f204:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"query"},[n("breadcrumb",{attrs:{data:["Clusters",t.$route.params.id,"query-execution"]}}),n("left-aside",{attrs:{list:t.list},on:{selectSql:t.selectSql}}),n("section",{staticClass:"container custom-scrollbar"},[n("tags",{attrs:{list:t.list,selectSql:t.selectedSql},on:{updateData:t.updateData}})],1)],1)},a=[],i=n("3355"),l=n("7f2c"),c=n("8cbb");function r(t,e){return t&&t.length?Object(c["a"])(t,Object(l["a"])(e,2)):[]}var u=r,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"left-aside-warp custom-scrollbar"},[n("div",{staticClass:"left-aside-content"},[n("ul",{staticClass:"custom-scrollbar"},[n("li",{staticClass:"flex flex-column ptb-15 plr-10 flex-center"},[n("span",{staticClass:"fs-18 font-bold mb-10"},[t._v(t._s(t.$t("queryExecution.Query History")))]),n("el-input",{staticClass:"width-200",attrs:{placeholder:"search",autocomplete:"false",clearable:""},on:{input:t.filterData},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}})],1),t._l(t.searchList,(function(e,s){return n("li",{key:s,class:["flex","flex-column","ptb-15","plr-10","flex-center","pointer",{active:t.activeIndex===s}],on:{click:function(n){return t.selectSql(e,s)}}},[n("span",{staticClass:"text-line-clamp"},[t._v(" "+t._s(e.value))])])}))],2)])])},f=[],h={props:{list:{type:Array,default:[]}},data:function(){return{input:"",searchList:this.list,activeIndex:-1}},mounted:function(){},methods:{filterData:function(){var t=this;""===this.input&&(this.searchList=this.list),this.searchList=this.searchList.filter((function(e){return e.value.includes(t.input)}))},selectSql:function(t,e){this.activeIndex=e,this.$emit("selectSql",t)}},watch:{list:function(t){this.searchList=t}}},p=h,d=(n("6e7d"),n("2877")),v=Object(d["a"])(p,o,f,!1,null,"218ce74b",null),m=v.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",[n("section",{staticClass:"rightSql custom-scrollbar"},[n("div",{staticClass:"tags flex-vcenter"},[t._l(t.tagsList,(function(e,s){return n("el-tag",{key:s,class:["fs-14","mr-10","pointer","tag","flex","flex-vcenter",{active:t.activeIndex===s}],attrs:{type:"info",closable:"","disable-transitions":!1},on:{close:function(n){return t.handleClose(e,s)},click:function(n){return t.clickTag(e,s)}}},[t._v(" "+t._s(e.value.length<10?""+e.value.substr(0,10):e.value.substr(0,10)+"...")+" ")])})),n("i",{staticClass:"fa fa-plus-square-o fs-28 pointer mr-10",on:{click:t.addTag}})],2)]),n("el-input",{ref:"elInput",staticClass:"width-full",attrs:{type:"textarea",autosize:{minRows:8},disabled:!this.tagsList.length},model:{value:t.sqlInput,callback:function(e){t.sqlInput=e},expression:"sqlInput"}}),n("el-button",{staticClass:"fs-18 width-full mt-15",attrs:{type:"primary",size:"large",disabled:""===t.sqlInput},on:{click:t.query}},[t._v(t._s(t.$t("queryExecution.Execute Query")))]),n("section",{staticClass:"list"},[n("el-table",{staticClass:"mt-15",attrs:{data:t.tableData,border:""}},t._l(t.columns,(function(t,e){return n("el-table-column",{key:e,attrs:{"show-overflow-tooltip":"",prop:t,label:t}})})),1)],1)],1)},g=[],q=n("a34a"),x=n.n(q),w=n("c949");function y(t,e,n,s,a,i,l){try{var c=t[i](l),r=c.value}catch(u){return void n(u)}c.done?e(r):Promise.resolve(r).then(s,a)}function I(t){return function(){var e=this,n=arguments;return new Promise((function(s,a){var i=t.apply(e,n);function l(t){y(i,s,a,l,c,"next",t)}function c(t){y(i,s,a,l,c,"throw",t)}l(void 0)}))}}var C={props:{selectSql:{type:Object,default:{}}},data:function(){return{sqlInput:"",tagsList:[],activeIndex:0,columns:[],tableData:[]}},mounted:function(){},methods:{addTag:function(){this.sqlInput="",this.tagsList.push({value:"",timestamp:(new Date).getTime()}),this.activeIndex=this.tagsList.length-1,this.$refs.elInput.focus()},handleClose:function(t,e){this.sqlInput="",this.tagsList.splice(e,1)},clickTag:function(t,e){this.activeIndex=e,this.sqlInput=t.value,this.$refs.elInput.focus()},query:function(){var t=this;return I(x.a.mark((function e(){var n,s,a;return x.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.tableData=[],e.next=3,w["f"].query({clusterName:t.$route.params.id,query:"".concat(t.sqlInput)});case 3:if(n=e.sent,s=n.data.entity,s.length&&(t.columns=s[0],s.splice(0,1),Object.values(s).map((function(e,n){var s={};e.forEach((function(e,n){s[t.columns[n]]=e})),t.tableData.push(s)}))),a=t.tagsList.find((function(e,n){return n===t.activeIndex})),a.value=t.sqlInput,a.value){e.next=11;break}return t.$message.warning("sql cannot be empty"),e.abrupt("return");case 11:t.$nextTick((function(){return t.$emit("updateData",a)}));case 12:case"end":return e.stop()}}),e)})))()}},watch:{selectSql:function(t){var e=this.tagsList.some((function(e){return e.value===t.value}));e?this.activeIndex=this.tagsList.findIndex((function(e){return e.value===t.value})):(this.tagsList.push(t),this.activeIndex=this.tagsList.length-1),this.sqlInput=t.value,this.$refs.elInput.focus()}}},L=C,k=(n("1607"),Object(d["a"])(L,b,g,!1,null,"2fc37e04",null)),S=k.exports,_={data:function(){return{list:[],selectedSql:{}}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=localStorage.getItem("sqlHisToryData");this.list="undefined"===t||Object(i["a"])(t)?[]:JSON.parse(t)},selectSql:function(t){this.selectedSql=t},updateData:function(t){this.list.unshift(t),console.log(this.list),this.list=u(this.list,"value"),localStorage.setItem("sqlHisToryData",JSON.stringify(this.list.slice(0,20))),this.fetchData()}},components:{LeftAside:m,Tags:S}},D=_,$=(n("8591"),Object(d["a"])(D,s,a,!1,null,"9326d328",null));e["default"]=$.exports}}]);